<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title | default: site.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <!-- Preload critical fonts -->
    <link rel="preload" href="{{ '/assets/fonts/Rinjani.otf' | relative_url }}" as="font" type="font/otf" crossorigin>
    <link rel="preload" href="{{ '/assets/fonts/RinjaniSemibold.otf' | relative_url }}" as="font" type="font/otf" crossorigin>
    <!-- Preload profile image -->
    <link rel="preload" href="{{ '/assets/images/profile.jpg' | relative_url }}" as="image">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Funnel+Display:wght@300..800&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <button class="hamburger" id="hamburger" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <a href="{{ '/' | relative_url }}" class="nav-brand">Krupa Patel</a>
                <div class="nav-links">
                    <a href="#projects">Projects</a>
                    <a href="#contact" class="btn-contact">Book Consultation</a>
                </div>
            </nav>
        </div>
    </header>
    
    <div class="mobile-menu" id="mobile-menu">
        <div class="mobile-menu-content">
            <button class="mobile-menu-close" id="mobile-menu-close">&times;</button>
            <a href="#projects" class="mobile-menu-link">Projects</a>
            <a href="#contact" class="mobile-menu-link">Book Consultation</a>
        </div>
    </div>
    {{ content }}
    
    <script>
        // Dynamic navbar height calculation for hero positioning
        function updateNavbarHeight() {
            const header = document.querySelector('.header');
            if (header) {
                const headerHeight = header.offsetHeight;
                document.documentElement.style.setProperty('--header-height', headerHeight + 'px');
            }
        }
        
        // Update on load and resize
        window.addEventListener('load', updateNavbarHeight);
        window.addEventListener('resize', updateNavbarHeight);
        // Update immediately
        updateNavbarHeight();

        // Mobile menu toggle
        const hamburger = document.getElementById('hamburger');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuClose = document.getElementById('mobile-menu-close');
        const mobileMenuLinks = document.querySelectorAll('.mobile-menu-link');
        
        // Open menu
        hamburger.addEventListener('click', () => {
            mobileMenu.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent scrolling when menu is open
        });
        
        // Close menu
        mobileMenuClose.addEventListener('click', () => {
            mobileMenu.classList.remove('active');
            document.body.style.overflow = ''; // Restore scrolling
        });
        
        // Close menu when clicking a link
        mobileMenuLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
            });
        });
        
        // Close menu when clicking outside
        mobileMenu.addEventListener('click', (e) => {
            if (e.target === mobileMenu) {
                mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // Mobile touch-triggered animations
        function initTouchAnimations() {
            // Only run on mobile devices (touch devices without hover)
            const isMobile = !window.matchMedia('(hover: hover)').matches && 
                           window.matchMedia('(pointer: coarse)').matches;
            
            if (!isMobile) return;
            
            // Project cards - bidirectional animations
            const projectCards = document.querySelectorAll('.project-card');
            
            projectCards.forEach(card => {
                // Touch start - activate animation
                card.addEventListener('touchstart', () => {
                    card.classList.add('touch-active');
                }, { passive: true });
                
                // Touch end - immediately revert animation (bidirectional)
                card.addEventListener('touchend', () => {
                    card.classList.remove('touch-active');
                }, { passive: true });
                
                // Touch cancel - immediately revert animation
                card.addEventListener('touchcancel', () => {
                    card.classList.remove('touch-active');
                }, { passive: true });
            });
            
            // Hero buttons - same touch animations as project cards
            const heroButtons = document.querySelectorAll('.hero-buttons .btn-primary');
            
            heroButtons.forEach(button => {
                // Touch start - activate animation
                button.addEventListener('touchstart', () => {
                    button.classList.add('touch-active');
                }, { passive: true });
                
                // Touch end - immediately revert animation (bidirectional)
                button.addEventListener('touchend', () => {
                    button.classList.remove('touch-active');
                }, { passive: true });
                
                // Touch cancel - immediately revert animation
                button.addEventListener('touchcancel', () => {
                    button.classList.remove('touch-active');
                }, { passive: true });
            });
            
            // Profile picture - same touch animations as hover effects
            const profileImage = document.querySelector('.hero-right .image-wrapper');
            
            if (profileImage) {
                // Touch start - activate animation
                profileImage.addEventListener('touchstart', () => {
                    profileImage.classList.add('touch-active');
                }, { passive: true });
                
                // Touch end - immediately revert animation (bidirectional)
                profileImage.addEventListener('touchend', () => {
                    profileImage.classList.remove('touch-active');
                }, { passive: true });
                
                // Touch cancel - immediately revert animation
                profileImage.addEventListener('touchcancel', () => {
                    profileImage.classList.remove('touch-active');
                }, { passive: true });
            }
        }
        
        // Initialize touch animations after DOM is loaded
        document.addEventListener('DOMContentLoaded', initTouchAnimations);
    </script>
</body>
</html>